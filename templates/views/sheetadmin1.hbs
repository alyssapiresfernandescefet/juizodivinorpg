<!DOCTYPE html>
<html>

<head>
    {{> head include_jqueryui=1}}
    <link rel="stylesheet" href="/styles/adminstyle.css">
    <script src="/scripts/admin1.js" defer></script>
    <script>socket.emit('room:join', 'admin');</script>
</head>

<body>
    <div class="container">
        <div class="row my-2">
            <div class="col text-start">
                <form action="/sheet/leave">
                    <button type="submit" class="btn btn-link h4">Sair</button>
                </form>
            </div>
            <div class="col text-end align-self-center">
                <a href="/portrait" class="h4">Acessar Retratos</a>
            </div>
            <div class="col text-end align-self-center">
                <a href="/sheet/admin/2" class="h4">Acessar 2° Página</a>
            </div>
        </div>
        <div class="row h1 text-center">
            <div class="col">Administrador</div>
        </div>
        <div class="row my-4">
            <div class="col text-center h5">
                <input class="form-check-input align-self-center" type="checkbox" id="changeEnvironment" {{#ifEquals
                    environmentState "combat" }}checked{{/ifEquals}}>
                <label class="form-check-label" for="changeEnvironment">
                    Ambiente de Combate?
                </label>
            </div>
        </div>
        <div class="row justify-content-center">
            {{#each characters}}
            {{#with this}}
            <div class="col-5 m-2 text-center acds-player-container" data-player-id="{{playerID}}"
                data-attribute-status="{{attributeStatus}}">
                <div class="row">
                    <div class="col">
                        <img class="img-fluid avatar">
                    </div>
                </div>
                <div class="row">
                    <div class="col h3 player-info" data-info-id="{{info.info_id}}" name="{{info.name}}">
                        {{info.value}}
                    </div>
                </div>
                <div class="row my-1">
                    <div class="col">
                        <div class="row">
                            <div class="col">
                                Classe: <span class="class-name">{{#if
                                    player.class_name}}{{player.class_name}}{{else}}Nenhuma{{/if}}</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-flex justify-content-center">
                                <label for="playerLineage{{@index}}"><span
                                        class="mx-2 align-self-center">Linhagem:</span></label>
                                <select id="playerLineage{{@index}}" class="acds-element text-center w-50"
                                    onchange="playerLineageChange(event);">
                                    <option value="0" {{#unless player}}selected{{/unless}}>Nenhuma</option>
                                    {{#each lineage}}
                                    {{#with this}}
                                    <option value="{{lineage_id}}" {{#ifEquals ../player.lineage_id
                                        lineage_id}}selected{{/ifEquals}}>{{name}}</option>
                                    {{/with}}
                                    {{/each}}
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                Pontos de Linhagem: <input
                                    class="acds-bottom-text acds-element player-score text-center" type="number"
                                    value="{{player.score}}" onchange="onPlayerScoreChanged(event);">
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row">
                    {{#each attributes}}
                    {{#with this}}
                    <div class="col">
                        <div class="row">
                            <div class="col h4 player-attribute" style="color: #{{fill_color}};"
                                data-attribute-id="{{attribute_id}}">
                                {{value}}/{{total_value}}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                {{name}}
                            </div>
                        </div>
                    </div>
                    {{/with}}
                    {{/each}}
                </div>
                <hr>
                <div class="row">
                    {{#each specs}}
                    {{#with this}}
                    <div class="col">
                        <div class="row">
                            <div class="col h4 player-spec" data-spec-id="{{spec_id}}">
                                {{value}}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                {{name}}
                            </div>
                        </div>
                    </div>
                    {{/with}}
                    {{/each}}
                </div>
                <hr>
                <div class="row">
                    {{#each characteristics}}
                    {{#with this}}
                    <div class="col">
                        <div class="row">
                            <div class="col h4 player-characteristic" data-characteristic-id="{{characteristic_id}}">
                                {{value}}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                {{name}}
                            </div>
                        </div>
                    </div>
                    {{/with}}
                    {{/each}}
                </div>
                <hr>
                <div class="row">
                    <div class="col h3">
                        Equipamentos
                    </div>
                </div>
                <div class="row">
                    <div class="col table-responsive">
                        <table class="table table-dark" style="--bs-table-bg: rgb(63, 68, 74);">
                            <thead>
                                <th scope="col">Usando</th>
                                <th scope="col">Nome</th>
                                <th scope="col">Dano</th>
                                <th scope="col">Alcance</th>
                                <th scope="col">Ataques</th>
                            </thead>
                            <tbody class="player-equipment-table">
                                {{#each equipments}}
                                {{> admin_equipment_row this}}
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col h3">
                        Inventário
                    </div>
                </div>
                <div class="row">
                    <div class="col table-responsive">
                        <table class="table table-sm table-borderless">
                            <tbody class="player-item-table">
                                {{#each items}}
                                {{#with this}}
                                {{> admin_item_row this}}
                                {{/with}}
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {{/with}}
            {{/each}}
        </div>
        <div class="row my-3 text-center acds-container">
            <div class="col">
                <div class="row my-3 h1 text-center">
                    <div class="col">Utilidades</div>
                </div>
                <hr>
                <div class="row my-4 text-center">
                    <div class="col">
                        <img class="img-fluid acds-clickable dice" src="/assets/dice.png" data-bs-toggle="modal"
                            data-bs-target="#generalDiceRoll">
                    </div>
                </div>
                <div class="row my-4">
                    <div class="col">
                        <div class="row">
                            <div class="col">

                            </div>
                        </div>
                        <div class="row">
                            <div class="col mx-3 acds-container table-wrapper">
                                <ul id="diceList" class="dice-list">
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row my-3 acds-container">
            <div class="col">
                <div class="row my-3">
                    <div class="col">
                        <div class="row h1 text-center">
                            <div class="col">Anotações</div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col">
                                {{#with adminNotes}}
                                <textarea id="adminAnotations" class="form-control acds-element"
                                    rows="20">{{value}}</textarea>
                                {{/with}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col my-2 text-start">
                <form action="/sheet/leave">
                    <button type="submit" class="btn btn-link h4">Sair</button>
                </form>
            </div>
            <div class="col mb-2 text-end align-self-center">
                <a href="/sheet/admin/2" class="h4">Acessar 2° Página</a>
            </div>
        </div>
    </div>

    {{!Templates}}
    <template id="equipmentRowTemplate">
        {{> admin_equipment_row}}
    </template>
    <template id="itemRowTemplate">
        {{> admin_item_row}}
    </template>

    {{> failuretoast}}
    {{> generaldice}}
    {{> diceroll}}
</body>

</html>